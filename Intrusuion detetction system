// sensor.go
package main

import (
	"bytes"
	"encoding/json"
	"fmt"
	"log"
	"net/http"
	"os"
	"time"

	"github.com/google/gopacket"
	"github.com/google/gopacket/layers"
	"github.com/google/gopacket/pcap"
)

// FlowKey identifies a unique network flow
type FlowKey struct {
	Src, Dst       string
	SPort, DPort   uint16
	Proto          string
}

// Stats holds flow-level statistics
type Stats struct {
	First, Last    time.Time
	PktsIn, PktsOut int
	BytesIn, BytesOut int
	IATs            []float64
	SYN, FIN, RST   int
}

// Flow is what we send to the Python IDS API
type Flow struct
